`Дисциплина: Методы и технологии машинного обучения`   
`Уровень подготовки: бакалавриат`   
`Направление подготовки: 01.03.02 Прикладная математика и информатика`   
`Семестр: осень 2022/2023`   
`Кузема София Евгеньевна`
# Лабораторная работа №4
Лабораторная работа №5
# Методы, основанные на деревьях решений. Регрессионные деревья. Деревья классификации. Бэггинг.
В практических примерах ниже показано:
  1. как делать перекодировку признаков в номинальной и порядковой шкалах
  2. как вырастить дерево и сделать обрезку его ветвей
  3. как настроить модель бэггинга
  4. как подбирать настроечные параметры моделей методом сеточного поиска
Точность всех моделей оценивается методом перекрёстной проверки по 5 блокам
Функция построения дерева классификации DecisionTreeClassifier() требует числовых порядковых значений переменных. Видно, что столбцы типа int64 либо порядковые (temperature), либо бинарные (все остальные), их преобразовывать нет необходимости.
# Распределение предикторов внутри классов по зависимой переменной
1. Все объясняющие переменные являются категориальными, поэтому оценивать их связь с зависимой переменной с помощью корреляционной матрицы некорректно. Вместо этого можно воспользоваться критерием согласия Хи-квадрат, который рассчитывается по таблице сопряжённости. Нулевая гипотеза теста: распределение долей в таблице сопряжённости случайно, т.е. два показателя независимы друг от друга.
Проведём тест для всех пар "объясняющая переменная" – "зависимая переменная" и выведем те пары, для которых соответствующее критерию p-значение больше 0.05 (т.е. нулевая гипотеза принимается, переменные независимы).
2. ![image](https://user-images.githubusercontent.com/93386717/207194102-acb55543-6d4d-489f-bb1d-f3e69a96661a.png)
3. Интересный результат: полное совпадение p-значений – объясняется тем, что на самом деле PAY_AMT6, PAY_AMT5, PAY_AMT4, PAY_AMT3, PAY_AMT2, PAY_AMT1 противоположны друг другу. Связь между ними функциональная: если направление на статуса платежа не совпадает с направлением на исходное место назначения (PAY_AMT6 == 1), то оно противоположно (PAY_AMT6 == -1), и наоборот. Поэтому в модель имело бы смысл включать только одну из, так и сделаем, однако стоит учитывать что P-значение равно 1, слишком много, смысла огромного нет.
# Перекодировка номинальной и порядковой шкалы
Перекодировка не требуется так как исходные данные уже заходированы.
# Модель дерева
![image](https://user-images.githubusercontent.com/93386717/207194692-9de90284-1c9e-4539-be4a-6d23b8094435.png)
![image](https://user-images.githubusercontent.com/93386717/207194766-58ab0e79-72c2-4fed-8c02-0bf3a8ca29c4.png)
Пример визуализации небольшого дерева:
![image](https://user-images.githubusercontent.com/93386717/207195107-c9575c87-8db1-447d-a1f8-3b6408ec34db.png)
![image](https://user-images.githubusercontent.com/93386717/207195165-72f76a20-73f7-4010-8c1c-ea6c4ac35b7a.png)
# Бэггинг
Модель бэггинга использует бутстреп, чтобы вырастить  деревьев на выборках с повторами из обучающих данных. Построим модель для  деревьев.
Итак, мы построили модель, выбрав параметр  случайным образом. Воспользуемся функцией GridSearchCV(), чтобы перебрать 8 вариантов значений для параметра.Таким образом, перебрав несколько вариантов для , мы немного улучшили первоначальную точность модели бэггинга
# Прогноз на отложенные наблюдения по лучшей модели
Все модели показывают среднюю точность по показателю , при этом самой точной оказывается модель Бэггинга. Сделаем прогноз на отложенные наблюдения.
![image](https://user-images.githubusercontent.com/93386717/207195732-1bc0cade-2f25-4fff-a6e4-794af7a1c7d5.png)



  
  
