# Лабораторная работа №6: Кластеризация

*Данные*: load_breast_cancer

Исходные данные содержат 569 наблюдений и 30 параметров

Для рассматрения возьмём средние значения 3-ёх признаков ядра клетки:
* **Concave points** - вогнутые точки
* **radius** - радиус
* **Concavity** - вогнутость

Задача состоит в разделении клеток на группы в зависимости от этих показателей

Перед рассмотрением данных была произведена стандартизация  
![image](https://user-images.githubusercontent.com/93386717/230991413-6ef0ab6b-9bff-4b47-b66d-834556c01dbb.png)  

По диаграмме рассеивания сложно предположить количество кластеров. Данные имеет скорее линейную зависимость. Однако, отчётливо видно скопление точек в нижнем левом углу. Предпологается наличие 3 кластеров (K1).  

## Определение оптимального количества кластеров для метода локтя

![image](https://user-images.githubusercontent.com/93386717/230992176-90f104ea-2140-45d1-b245-6a14103287b9.png)  


Как видно на графике выше, локоть расположен в k равным 2, что свидетельствует о том, что это значение является хорошим выбором для этого набора данных. Изначально предпологалось большее количество кластеров, поэтому оценка качества кластеризации проведём по обоим вариантам кол-ва кластеров.  

![image](https://user-images.githubusercontent.com/93386717/230992305-6d9569ac-b7ab-40ad-aeb0-9f0d565d774e.png)  

![image](https://user-images.githubusercontent.com/93386717/230992339-f6c668fd-1465-44ef-8a95-d138f0bd0d53.png)  

Теперь видим, что каждая группа точек покрашена в цвет соответствующего кластера, зелёным помечены центры кластреров (центроиды). Попробуем оценить качество кластеризации в обоих вариантах.  

## Количественная оценка качества кластеризации

![image](https://user-images.githubusercontent.com/93386717/230992466-1c480602-f00f-486a-81d8-e1185c5af87c.png)  

Средний коэффициент силуэта --  0.47275221126140693

![image](https://user-images.githubusercontent.com/93386717/230992532-8e8cb2a1-249e-4549-b648-d41cfecc67d3.png)  

Средний коэффициент силуэта --  0.592701999305466

Среднее значение силуэтного коэффициента выше во втором случае, когда количество кластеров равняется 2. Это является в порядке вещей, ведь раковые клетки, прогнозируемая переменная в выборке данных, могут быть только доброкачественные и злокачественные  

## Сравнение результатов на обучающей и тестовой выборке
Посмотрим, как прогнозировать принадлежность к кластерам, построенным по обучающим данным. Сравним значения средних силуэтных коэффициентов.

В обучающей выборке - 80% исходных наблюдений.
Последующие действия будем выполнять с учётом третьего показателя  

![image](https://user-images.githubusercontent.com/93386717/230992721-a84b825d-df68-425d-92e1-c5e0e5921765.png)  

Видно изменение масштаба графика. По сравнению с 2 переменными искажение показывает большие значения.  
При это перелом стал более выраженным на 2 кластерах  

На обучающей выборке  
Средний коэффициент силуэта --  0.5915433702748035  
Значение среднего силуэтного коэффициента ухудшилось, хоть и не намного.  

Средний коэффициент силуэта --  0.5652892733719388  
На прогнозной выборки значение коэффициента ещё уменьшилось, хотя опять же не критично.

## Статистический анализ получившихся кластеров

![image](https://user-images.githubusercontent.com/93386717/230992965-dadd60f1-f94c-4e1e-841f-aa3d339eae90.png)  

Между признаками скорее прослеживаются линейные зависимости, хотя в этом случае стоит ожидать не очень удовлетворительных результатов. Рассеивание скорее всего будет слишком большое относительно прямой  

## Оценка точности кластеризации с помощью Acc, сравнив оценки с фактическим разбиением на группы.

Acc = 0.9033391915641477  

## Вывод

Таким образом, с точностью 90.3% два параметра concave points и radius корректно определяют принадлежность к доброкачественной или злокачественной группе  
